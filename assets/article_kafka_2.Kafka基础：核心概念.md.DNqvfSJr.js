import{_ as a,c as i,o as n,ae as e}from"./chunks/framework.DI6M9D4h.js";const d=JSON.parse('{"title":"Kafka基础：核心概念","description":"深入理解Kafka的核心概念，包括Topic、Partition、Producer、Consumer等","frontmatter":{"title":"Kafka基础：核心概念","date":"2026-01-15T00:00:00.000Z","description":"深入理解Kafka的核心概念，包括Topic、Partition、Producer、Consumer等"},"headers":[],"relativePath":"article/kafka/2.Kafka基础：核心概念.md","filePath":"article/kafka/2.Kafka基础：核心概念.md"}'),r={name:"article/kafka/2.Kafka基础：核心概念.md"};function l(t,s,p,o,h,c){return n(),i("div",null,[...s[0]||(s[0]=[e(`<h1 id="kafka基础-核心概念" tabindex="-1">Kafka基础：核心概念 <a class="header-anchor" href="#kafka基础-核心概念" aria-label="Permalink to &quot;Kafka基础：核心概念&quot;">​</a></h1><p>理解Kafka的核心概念是掌握Kafka的关键。本课将深入讲解Kafka的各个核心组件和概念。</p><h2 id="一、topic-主题" tabindex="-1">一、Topic（主题） <a class="header-anchor" href="#一、topic-主题" aria-label="Permalink to &quot;一、Topic（主题）&quot;">​</a></h2><h3 id="_1-1-topic的概念" tabindex="-1">1.1 Topic的概念 <a class="header-anchor" href="#_1-1-topic的概念" aria-label="Permalink to &quot;1.1 Topic的概念&quot;">​</a></h3><p>Topic是Kafka中消息的逻辑分类，类似于数据库中的表。生产者将消息发送到Topic，消费者从Topic读取消息。</p><h3 id="_1-2-topic的特点" tabindex="-1">1.2 Topic的特点 <a class="header-anchor" href="#_1-2-topic的特点" aria-label="Permalink to &quot;1.2 Topic的特点&quot;">​</a></h3><ul><li><strong>多生产者</strong>：多个Producer可以向同一个Topic发送消息</li><li><strong>多消费者</strong>：多个Consumer可以从同一个Topic读取消息</li><li><strong>持久化</strong>：消息持久化到磁盘，不会因为消费而删除</li><li><strong>可配置</strong>：可以配置消息保留时间、压缩策略等</li></ul><h3 id="_1-3-topic的创建" tabindex="-1">1.3 Topic的创建 <a class="header-anchor" href="#_1-3-topic的创建" aria-label="Permalink to &quot;1.3 Topic的创建&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建Topic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-topics.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --partitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --replication-factor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 参数说明：</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># --partitions: 分区数量</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># --replication-factor: 副本数量</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="二、partition-分区" tabindex="-1">二、Partition（分区） <a class="header-anchor" href="#二、partition-分区" aria-label="Permalink to &quot;二、Partition（分区）&quot;">​</a></h2><h3 id="_2-1-partition的概念" tabindex="-1">2.1 Partition的概念 <a class="header-anchor" href="#_2-1-partition的概念" aria-label="Permalink to &quot;2.1 Partition的概念&quot;">​</a></h3><p>Partition是Topic的物理分区，一个Topic可以有一个或多个Partition。Partition是Kafka实现并行处理和水平扩展的基础。</p><h3 id="_2-2-partition的作用" tabindex="-1">2.2 Partition的作用 <a class="header-anchor" href="#_2-2-partition的作用" aria-label="Permalink to &quot;2.2 Partition的作用&quot;">​</a></h3><ol><li><strong>并行处理</strong>：多个Partition可以并行处理，提高吞吐量</li><li><strong>水平扩展</strong>：可以通过增加Partition数量来扩展Topic的容量</li><li><strong>消息顺序</strong>：同一Partition内的消息是有序的</li><li><strong>负载均衡</strong>：消息可以分布到不同的Partition</li></ol><h3 id="_2-3-partition的存储" tabindex="-1">2.3 Partition的存储 <a class="header-anchor" href="#_2-3-partition的存储" aria-label="Permalink to &quot;2.3 Partition的存储&quot;">​</a></h3><p>每个Partition在物理上是一个目录，存储在该Partition的Leader Broker上：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>/opt/kafka/data/my-topic-0/</span></span>
<span class="line"><span>/opt/kafka/data/my-topic-1/</span></span>
<span class="line"><span>/opt/kafka/data/my-topic-2/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_2-4-partition的分配" tabindex="-1">2.4 Partition的分配 <a class="header-anchor" href="#_2-4-partition的分配" aria-label="Permalink to &quot;2.4 Partition的分配&quot;">​</a></h3><p>消息如何分配到Partition？</p><ol><li><strong>指定Partition</strong>：Producer可以指定消息发送到哪个Partition</li><li><strong>Key分区</strong>：如果消息有Key，会根据Key的hash值分配到Partition</li><li><strong>轮询分配</strong>：如果没有Key，会轮询分配到各个Partition</li></ol><h3 id="_2-5-查看partition信息" tabindex="-1">2.5 查看Partition信息 <a class="header-anchor" href="#_2-5-查看partition信息" aria-label="Permalink to &quot;2.5 查看Partition信息&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看Topic的Partition信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-topics.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --describe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>输出示例：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Topic: my-topic	PartitionCount: 3	ReplicationFactor: 1</span></span>
<span class="line"><span>	Topic: my-topic	Partition: 0	Leader: 0	Replicas: 0	Isr: 0</span></span>
<span class="line"><span>	Topic: my-topic	Partition: 1	Leader: 0	Replicas: 0	Isr: 0</span></span>
<span class="line"><span>	Topic: my-topic	Partition: 2	Leader: 0	Replicas: 0	Isr: 0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="三、replication-副本" tabindex="-1">三、Replication（副本） <a class="header-anchor" href="#三、replication-副本" aria-label="Permalink to &quot;三、Replication（副本）&quot;">​</a></h2><h3 id="_3-1-replication的概念" tabindex="-1">3.1 Replication的概念 <a class="header-anchor" href="#_3-1-replication的概念" aria-label="Permalink to &quot;3.1 Replication的概念&quot;">​</a></h3><p>Replication是Kafka实现高可用的机制。每个Partition可以有多个副本（Replica），分布在不同的Broker上。</p><h3 id="_3-2-leader和follower" tabindex="-1">3.2 Leader和Follower <a class="header-anchor" href="#_3-2-leader和follower" aria-label="Permalink to &quot;3.2 Leader和Follower&quot;">​</a></h3><ul><li><strong>Leader</strong>：每个Partition有一个Leader，负责处理所有的读写请求</li><li><strong>Follower</strong>：其他副本是Follower，从Leader同步数据</li></ul><h3 id="_3-3-replication的作用" tabindex="-1">3.3 Replication的作用 <a class="header-anchor" href="#_3-3-replication的作用" aria-label="Permalink to &quot;3.3 Replication的作用&quot;">​</a></h3><ol><li><strong>高可用</strong>：Leader故障时，Follower可以成为新的Leader</li><li><strong>数据冗余</strong>：多个副本保证数据不丢失</li><li><strong>负载均衡</strong>：Follower可以处理读请求（需要配置）</li></ol><h3 id="_3-4-isr-in-sync-replicas" tabindex="-1">3.4 ISR（In-Sync Replicas） <a class="header-anchor" href="#_3-4-isr-in-sync-replicas" aria-label="Permalink to &quot;3.4 ISR（In-Sync Replicas）&quot;">​</a></h3><p>ISR是与Leader保持同步的副本集合。只有ISR中的副本才有资格成为新的Leader。</p><h2 id="四、producer-生产者" tabindex="-1">四、Producer（生产者） <a class="header-anchor" href="#四、producer-生产者" aria-label="Permalink to &quot;四、Producer（生产者）&quot;">​</a></h2><h3 id="_4-1-producer的概念" tabindex="-1">4.1 Producer的概念 <a class="header-anchor" href="#_4-1-producer的概念" aria-label="Permalink to &quot;4.1 Producer的概念&quot;">​</a></h3><p>Producer是向Kafka Topic发送消息的客户端。Producer负责将消息序列化并发送到指定的Topic和Partition。</p><h3 id="_4-2-producer的工作流程" tabindex="-1">4.2 Producer的工作流程 <a class="header-anchor" href="#_4-2-producer的工作流程" aria-label="Permalink to &quot;4.2 Producer的工作流程&quot;">​</a></h3><ol><li><strong>序列化消息</strong>：将消息对象序列化为字节数组</li><li><strong>选择Partition</strong>：根据分区策略选择目标Partition</li><li><strong>发送到Broker</strong>：将消息发送到对应Partition的Leader Broker</li><li><strong>确认响应</strong>：等待Broker的确认响应</li></ol><h3 id="_4-3-producer的类型" tabindex="-1">4.3 Producer的类型 <a class="header-anchor" href="#_4-3-producer的类型" aria-label="Permalink to &quot;4.3 Producer的类型&quot;">​</a></h3><ul><li><strong>同步Producer</strong>：发送消息后等待响应</li><li><strong>异步Producer</strong>：发送消息后不等待响应，通过回调处理结果</li></ul><h2 id="五、consumer-消费者" tabindex="-1">五、Consumer（消费者） <a class="header-anchor" href="#五、consumer-消费者" aria-label="Permalink to &quot;五、Consumer（消费者）&quot;">​</a></h2><h3 id="_5-1-consumer的概念" tabindex="-1">5.1 Consumer的概念 <a class="header-anchor" href="#_5-1-consumer的概念" aria-label="Permalink to &quot;5.1 Consumer的概念&quot;">​</a></h3><p>Consumer是从Kafka Topic读取消息的客户端。Consumer负责从指定的Topic和Partition读取消息并处理。</p><h3 id="_5-2-consumer的工作流程" tabindex="-1">5.2 Consumer的工作流程 <a class="header-anchor" href="#_5-2-consumer的工作流程" aria-label="Permalink to &quot;5.2 Consumer的工作流程&quot;">​</a></h3><ol><li><strong>订阅Topic</strong>：Consumer订阅一个或多个Topic</li><li><strong>分配Partition</strong>：Consumer Group协调分配Partition给各个Consumer</li><li><strong>拉取消息</strong>：Consumer从分配的Partition拉取消息</li><li><strong>处理消息</strong>：处理消息并提交Offset</li></ol><h3 id="_5-3-consumer的拉取模式" tabindex="-1">5.3 Consumer的拉取模式 <a class="header-anchor" href="#_5-3-consumer的拉取模式" aria-label="Permalink to &quot;5.3 Consumer的拉取模式&quot;">​</a></h3><p>Kafka使用<strong>拉取（Pull）模式</strong>，Consumer主动从Broker拉取消息，而不是Broker推送消息。</p><p><strong>优势</strong>：</p><ul><li>Consumer可以控制消费速度</li><li>Consumer可以批量拉取消息</li><li>避免Broker推送消息时Consumer来不及处理</li></ul><h2 id="六、consumer-group-消费者组" tabindex="-1">六、Consumer Group（消费者组） <a class="header-anchor" href="#六、consumer-group-消费者组" aria-label="Permalink to &quot;六、Consumer Group（消费者组）&quot;">​</a></h2><h3 id="_6-1-consumer-group的概念" tabindex="-1">6.1 Consumer Group的概念 <a class="header-anchor" href="#_6-1-consumer-group的概念" aria-label="Permalink to &quot;6.1 Consumer Group的概念&quot;">​</a></h3><p>Consumer Group是一组Consumer的集合，它们共同消费一个或多个Topic。同一个Consumer Group中的Consumer会协调分配Partition。</p><h3 id="_6-2-consumer-group的作用" tabindex="-1">6.2 Consumer Group的作用 <a class="header-anchor" href="#_6-2-consumer-group的作用" aria-label="Permalink to &quot;6.2 Consumer Group的作用&quot;">​</a></h3><ol><li><strong>负载均衡</strong>：将Topic的Partition分配给不同的Consumer</li><li><strong>并行消费</strong>：多个Consumer并行处理消息</li><li><strong>容错性</strong>：Consumer故障时，其Partition会重新分配给其他Consumer</li></ol><h3 id="_6-3-partition分配规则" tabindex="-1">6.3 Partition分配规则 <a class="header-anchor" href="#_6-3-partition分配规则" aria-label="Permalink to &quot;6.3 Partition分配规则&quot;">​</a></h3><ul><li>一个Partition只能被同一个Consumer Group中的一个Consumer消费</li><li>一个Consumer可以消费多个Partition</li><li>Partition数量应该大于等于Consumer数量，否则会有Consumer空闲</li></ul><h3 id="_6-4-consumer-group示例" tabindex="-1">6.4 Consumer Group示例 <a class="header-anchor" href="#_6-4-consumer-group示例" aria-label="Permalink to &quot;6.4 Consumer Group示例&quot;">​</a></h3><p>假设Topic有3个Partition，Consumer Group有2个Consumer：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Partition 0 -&gt; Consumer 1</span></span>
<span class="line"><span>Partition 1 -&gt; Consumer 1</span></span>
<span class="line"><span>Partition 2 -&gt; Consumer 2</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="_6-5-查看consumer-group" tabindex="-1">6.5 查看Consumer Group <a class="header-anchor" href="#_6-5-查看consumer-group" aria-label="Permalink to &quot;6.5 查看Consumer Group&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看Consumer Group列表</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-consumer-groups.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --list</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看Consumer Group详情</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-consumer-groups.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --describe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="七、offset-偏移量" tabindex="-1">七、Offset（偏移量） <a class="header-anchor" href="#七、offset-偏移量" aria-label="Permalink to &quot;七、Offset（偏移量）&quot;">​</a></h2><h3 id="_7-1-offset的概念" tabindex="-1">7.1 Offset的概念 <a class="header-anchor" href="#_7-1-offset的概念" aria-label="Permalink to &quot;7.1 Offset的概念&quot;">​</a></h3><p>Offset是消息在Partition中的位置标识，类似于数组的索引。每个Consumer都会记录自己消费到哪个Offset。</p><h3 id="_7-2-offset的作用" tabindex="-1">7.2 Offset的作用 <a class="header-anchor" href="#_7-2-offset的作用" aria-label="Permalink to &quot;7.2 Offset的作用&quot;">​</a></h3><ol><li><strong>消费位置记录</strong>：记录Consumer消费到哪个位置</li><li><strong>断点续传</strong>：Consumer重启后可以从上次的Offset继续消费</li><li><strong>消息重放</strong>：可以从指定的Offset重新消费消息</li></ol><h3 id="_7-3-offset的存储" tabindex="-1">7.3 Offset的存储 <a class="header-anchor" href="#_7-3-offset的存储" aria-label="Permalink to &quot;7.3 Offset的存储&quot;">​</a></h3><p>Offset可以存储在：</p><ol><li><strong>Kafka内部</strong>（推荐）：存储在<code>__consumer_offsets</code> Topic中</li><li><strong>外部存储</strong>：存储在数据库、Redis等外部系统</li></ol><h3 id="_7-4-offset的提交" tabindex="-1">7.4 Offset的提交 <a class="header-anchor" href="#_7-4-offset的提交" aria-label="Permalink to &quot;7.4 Offset的提交&quot;">​</a></h3><ul><li><strong>自动提交</strong>：Consumer自动定期提交Offset</li><li><strong>手动提交</strong>：Consumer处理完消息后手动提交Offset</li></ul><h3 id="_7-5-offset的管理" tabindex="-1">7.5 Offset的管理 <a class="header-anchor" href="#_7-5-offset的管理" aria-label="Permalink to &quot;7.5 Offset的管理&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看Consumer Group的Offset</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-consumer-groups.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --describe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重置Offset（谨慎操作）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-consumer-groups.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --reset-offsets</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --to-earliest</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --execute</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="八、broker-代理" tabindex="-1">八、Broker（代理） <a class="header-anchor" href="#八、broker-代理" aria-label="Permalink to &quot;八、Broker（代理）&quot;">​</a></h2><h3 id="_8-1-broker的概念" tabindex="-1">8.1 Broker的概念 <a class="header-anchor" href="#_8-1-broker的概念" aria-label="Permalink to &quot;8.1 Broker的概念&quot;">​</a></h3><p>Broker是Kafka服务器节点，负责存储消息和处理读写请求。一个Kafka集群由多个Broker组成。</p><h3 id="_8-2-broker的作用" tabindex="-1">8.2 Broker的作用 <a class="header-anchor" href="#_8-2-broker的作用" aria-label="Permalink to &quot;8.2 Broker的作用&quot;">​</a></h3><ol><li><strong>消息存储</strong>：存储Topic的Partition数据</li><li><strong>请求处理</strong>：处理Producer和Consumer的请求</li><li><strong>副本管理</strong>：管理Partition的副本同步</li></ol><h3 id="_8-3-broker的标识" tabindex="-1">8.3 Broker的标识 <a class="header-anchor" href="#_8-3-broker的标识" aria-label="Permalink to &quot;8.3 Broker的标识&quot;">​</a></h3><p>每个Broker有一个唯一的ID（broker.id），用于标识集群中的不同Broker。</p><h2 id="九、消息的流转过程" tabindex="-1">九、消息的流转过程 <a class="header-anchor" href="#九、消息的流转过程" aria-label="Permalink to &quot;九、消息的流转过程&quot;">​</a></h2><h3 id="_9-1-消息发送流程" tabindex="-1">9.1 消息发送流程 <a class="header-anchor" href="#_9-1-消息发送流程" aria-label="Permalink to &quot;9.1 消息发送流程&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Producer -&gt; 序列化消息 -&gt; 选择Partition -&gt; 发送到Leader Broker -&gt; 写入磁盘 -&gt; 返回确认</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h3 id="_9-2-消息消费流程" tabindex="-1">9.2 消息消费流程 <a class="header-anchor" href="#_9-2-消息消费流程" aria-label="Permalink to &quot;9.2 消息消费流程&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Consumer -&gt; 订阅Topic -&gt; 加入Consumer Group -&gt; 分配Partition -&gt; 拉取消息 -&gt; 处理消息 -&gt; 提交Offset</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="十、核心概念总结" tabindex="-1">十、核心概念总结 <a class="header-anchor" href="#十、核心概念总结" aria-label="Permalink to &quot;十、核心概念总结&quot;">​</a></h2><h3 id="_10-1-概念关系图" tabindex="-1">10.1 概念关系图 <a class="header-anchor" href="#_10-1-概念关系图" aria-label="Permalink to &quot;10.1 概念关系图&quot;">​</a></h3><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>Topic (逻辑分类)</span></span>
<span class="line"><span>  └── Partition 0 (物理分区)</span></span>
<span class="line"><span>      ├── Replica 0 (Leader)</span></span>
<span class="line"><span>      └── Replica 1 (Follower)</span></span>
<span class="line"><span>  └── Partition 1</span></span>
<span class="line"><span>      ├── Replica 0 (Leader)</span></span>
<span class="line"><span>      └── Replica 1 (Follower)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>Producer -&gt; Topic -&gt; Partition -&gt; Broker</span></span>
<span class="line"><span>Consumer Group -&gt; Consumer -&gt; Partition -&gt; Offset</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="_10-2-关键要点" tabindex="-1">10.2 关键要点 <a class="header-anchor" href="#_10-2-关键要点" aria-label="Permalink to &quot;10.2 关键要点&quot;">​</a></h3><ol><li><strong>Topic是逻辑分类，Partition是物理分区</strong></li><li><strong>一个Topic可以有多个Partition，实现并行处理</strong></li><li><strong>Replication保证高可用，Leader处理读写请求</strong></li><li><strong>Consumer Group实现负载均衡和并行消费</strong></li><li><strong>Offset记录消费位置，支持断点续传</strong></li></ol><h2 id="十一、实践练习" tabindex="-1">十一、实践练习 <a class="header-anchor" href="#十一、实践练习" aria-label="Permalink to &quot;十一、实践练习&quot;">​</a></h2><h3 id="练习1-创建多分区topic" tabindex="-1">练习1：创建多分区Topic <a class="header-anchor" href="#练习1-创建多分区topic" aria-label="Permalink to &quot;练习1：创建多分区Topic&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 创建一个有5个分区的Topic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-topics.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --create</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-partition-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --partitions</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --replication-factor</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看分区信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-topics.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --describe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-partition-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="练习2-观察消息分区" tabindex="-1">练习2：观察消息分区 <a class="header-anchor" href="#练习2-观察消息分区" aria-label="Permalink to &quot;练习2：观察消息分区&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 发送带Key的消息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-console-producer.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-partition-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --property</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;parse.key=true&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --property</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;key.separator=:&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输入：key1:message1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输入：key2:message2</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 输入：key1:message3 (相同key会到同一分区)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="练习3-观察consumer-group" tabindex="-1">练习3：观察Consumer Group <a class="header-anchor" href="#练习3-观察consumer-group" aria-label="Permalink to &quot;练习3：观察Consumer Group&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动第一个Consumer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-console-consumer.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-partition-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 启动第二个Consumer（新终端）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-console-consumer.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --topic</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> multi-partition-topic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看Consumer Group分配</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">bin/kafka-consumer-groups.sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --bootstrap-server</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> localhost:9092</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --describe</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> \\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  --group</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> my-group</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h2 id="十二、下一步学习" tabindex="-1">十二、下一步学习 <a class="header-anchor" href="#十二、下一步学习" aria-label="Permalink to &quot;十二、下一步学习&quot;">​</a></h2><p>完成本课后，你应该能够：</p><ul><li>✅ 理解Topic和Partition的概念和关系</li><li>✅ 理解Replication和Leader/Follower机制</li><li>✅ 理解Producer和Consumer的工作原理</li><li>✅ 理解Consumer Group和负载均衡</li><li>✅ 理解Offset的作用和管理</li></ul><p>接下来可以学习：</p><ol><li><strong>第3课：消息生产</strong> - 学习使用Producer API发送消息</li><li><strong>第4课：消息消费</strong> - 学习使用Consumer API消费消息</li></ol><h2 id="十三、总结" tabindex="-1">十三、总结 <a class="header-anchor" href="#十三、总结" aria-label="Permalink to &quot;十三、总结&quot;">​</a></h2><ul><li>Topic是消息的逻辑分类，Partition是物理分区</li><li>Replication通过Leader/Follower机制保证高可用</li><li>Producer发送消息到Topic的Partition</li><li>Consumer从Topic的Partition读取消息</li><li>Consumer Group实现负载均衡和并行消费</li><li>Offset记录消费位置，支持断点续传</li></ul><p>深入理解这些核心概念，是掌握Kafka的基础！</p>`,105)])])}const u=a(r,[["render",l]]);export{d as __pageData,u as default};
