import{_ as a,c as n,o as i,ae as l}from"./chunks/framework.DI6M9D4h.js";const b=JSON.parse('{"title":"DHCP动态主机配置","description":"深入理解DHCP协议，掌握IP地址自动分配机制","frontmatter":{"title":"DHCP动态主机配置","date":"2026-01-12T00:00:00.000Z","description":"深入理解DHCP协议，掌握IP地址自动分配机制"},"headers":[],"relativePath":"article/network/5.DHCP动态主机配置.md","filePath":"article/network/5.DHCP动态主机配置.md"}'),p={name:"article/network/5.DHCP动态主机配置.md"};function e(t,s,r,h,d,c){return i(),n("div",null,[...s[0]||(s[0]=[l(`<h1 id="dhcp动态主机配置" tabindex="-1">DHCP动态主机配置 <a class="header-anchor" href="#dhcp动态主机配置" aria-label="Permalink to &quot;DHCP动态主机配置&quot;">​</a></h1><h2 id="一、什么是dhcp" tabindex="-1">一、什么是DHCP <a class="header-anchor" href="#一、什么是dhcp" aria-label="Permalink to &quot;一、什么是DHCP&quot;">​</a></h2><h3 id="_1-什么是dhcp" tabindex="-1">1 什么是DHCP <a class="header-anchor" href="#_1-什么是dhcp" aria-label="Permalink to &quot;1 什么是DHCP&quot;">​</a></h3><p>DHCP（Dynamic Host Configuration Protocol，动态主机配置协议）是一种网络管理协议，用于自动为网络中的设备分配IP地址和其他网络配置参数。</p><p><strong>主要功能</strong>：</p><ul><li>自动分配IP地址</li><li>分配子网掩码</li><li>分配默认网关</li><li>分配DNS服务器地址</li><li>分配租约时间</li><li>其他网络参数（如NTP服务器、域名等）</li></ul><p><strong>优势</strong>：</p><ul><li>✅ <strong>自动化</strong>：无需手动配置每台设备</li><li>✅ <strong>集中管理</strong>：统一管理IP地址分配</li><li>✅ <strong>减少错误</strong>：避免IP地址冲突和配置错误</li><li>✅ <strong>灵活分配</strong>：支持动态和静态分配</li><li>✅ <strong>节省资源</strong>：设备断开时IP地址可回收</li></ul><h3 id="_2-dhcp工作原理" tabindex="-1">2 DHCP工作原理 <a class="header-anchor" href="#_2-dhcp工作原理" aria-label="Permalink to &quot;2 DHCP工作原理&quot;">​</a></h3><h4 id="_2-1-dhcp工作流程-dora过程" tabindex="-1">2.1 DHCP工作流程（DORA过程） <a class="header-anchor" href="#_2-1-dhcp工作流程-dora过程" aria-label="Permalink to &quot;2.1 DHCP工作流程（DORA过程）&quot;">​</a></h4><p>DHCP使用四个步骤完成IP地址分配，称为DORA过程：</p><p><strong>1. Discover（发现）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 广播 → DHCP服务器</span></span>
<span class="line"><span>&quot;我需要一个IP地址！&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>客户端启动时，发送DHCP Discover广播包</li><li>源IP：0.0.0.0（客户端还没有IP地址）</li><li>目标IP：255.255.255.255（广播地址）</li><li>目的：寻找网络中的DHCP服务器</li></ul><p><strong>2. Offer（提供）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DHCP服务器 → 广播 → 客户端</span></span>
<span class="line"><span>&quot;我可以给你这个IP地址：192.168.1.100&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>DHCP服务器收到Discover后，从地址池中选择一个可用IP</li><li>发送DHCP Offer广播包，包含： <ul><li>分配的IP地址</li><li>子网掩码</li><li>默认网关</li><li>DNS服务器</li><li>租约时间</li></ul></li></ul><p><strong>3. Request（请求）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 广播 → DHCP服务器</span></span>
<span class="line"><span>&quot;我接受这个IP地址：192.168.1.100&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>客户端收到Offer后，发送DHCP Request广播包</li><li>通知服务器接受提供的IP地址</li><li>同时通知其他DHCP服务器（如果有多个）拒绝它们的Offer</li></ul><p><strong>4. Acknowledge（确认）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DHCP服务器 → 广播 → 客户端</span></span>
<span class="line"><span>&quot;确认！IP地址 192.168.1.100 已分配给你&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>DHCP服务器发送DHCP ACK确认包</li><li>客户端收到后，配置网络参数</li><li>IP地址分配完成</li></ul><p><strong>完整流程图</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端                    网络                     DHCP服务器</span></span>
<span class="line"><span>  |                        |                          |</span></span>
<span class="line"><span>  |---DHCP Discover-------&gt;|-------------------------&gt;|</span></span>
<span class="line"><span>  |   (广播)                |                          |</span></span>
<span class="line"><span>  |                        |                          |</span></span>
<span class="line"><span>  |&lt;--DHCP Offer-----------|&lt;--------------------------|</span></span>
<span class="line"><span>  |   (广播)                |                          |</span></span>
<span class="line"><span>  |                        |                          |</span></span>
<span class="line"><span>  |---DHCP Request--------&gt;|-------------------------&gt;|</span></span>
<span class="line"><span>  |   (广播)                |                          |</span></span>
<span class="line"><span>  |                        |                          |</span></span>
<span class="line"><span>  |&lt;--DHCP ACK-------------|&lt;--------------------------|</span></span>
<span class="line"><span>  |   (广播)                |                          |</span></span>
<span class="line"><span>  |                        |                          |</span></span>
<span class="line"><span>  | 配置IP地址和网络参数    |                          |</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h4 id="_2-2-dhcp租约机制" tabindex="-1">2.2 DHCP租约机制 <a class="header-anchor" href="#_2-2-dhcp租约机制" aria-label="Permalink to &quot;2.2 DHCP租约机制&quot;">​</a></h4><p><strong>租约时间（Lease Time）</strong>：</p><ul><li>DHCP分配的IP地址有使用期限</li><li>默认租约时间通常为： <ul><li>家庭路由器：24小时（86400秒）</li><li>企业网络：8小时（28800秒）</li><li>可自定义配置</li></ul></li></ul><p><strong>租约更新过程</strong>：</p><p><strong>1. T1时间（50%租约时间）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → DHCP服务器</span></span>
<span class="line"><span>&quot;我想续租这个IP地址&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>客户端在租约时间过半时，尝试续租</li><li>发送DHCP Request（单播）</li><li>如果服务器同意，更新租约时间</li></ul><p><strong>2. T2时间（87.5%租约时间）</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端 → 广播</span></span>
<span class="line"><span>&quot;任何DHCP服务器，我想续租IP地址&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>如果T1续租失败，在87.5%租约时间时广播请求</li><li>允许从其他DHCP服务器获取新地址</li></ul><p><strong>3. 租约到期</strong></p><ul><li>如果续租失败，IP地址被回收</li><li>客户端需要重新进行DORA过程</li></ul><p><strong>租约时间示例</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>租约时间：24小时（86400秒）</span></span>
<span class="line"><span>T1时间：12小时（43200秒）- 开始续租</span></span>
<span class="line"><span>T2时间：21小时（75600秒）- 广播续租</span></span>
<span class="line"><span>到期时间：24小时（86400秒）- IP地址回收</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="_3-dhcp服务器配置" tabindex="-1">3 DHCP服务器配置 <a class="header-anchor" href="#_3-dhcp服务器配置" aria-label="Permalink to &quot;3 DHCP服务器配置&quot;">​</a></h3><h4 id="_3-1-路由器dhcp配置-家庭网络" tabindex="-1">3.1 路由器DHCP配置（家庭网络） <a class="header-anchor" href="#_3-1-路由器dhcp配置-家庭网络" aria-label="Permalink to &quot;3.1 路由器DHCP配置（家庭网络）&quot;">​</a></h4><p>典型的家庭路由器DHCP配置：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>DHCP服务器：启用</span></span>
<span class="line"><span>IP地址池范围：192.168.1.100 ~ 192.168.1.200</span></span>
<span class="line"><span>子网掩码：255.255.255.0</span></span>
<span class="line"><span>默认网关：192.168.1.1</span></span>
<span class="line"><span>DNS服务器1：192.168.1.1（路由器）</span></span>
<span class="line"><span>DNS服务器2：8.8.8.8（Google DNS）</span></span>
<span class="line"><span>租约时间：86400秒（24小时）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>配置步骤</strong>（以TP-Link路由器为例）：</p><ol><li>登录路由器管理界面（192.168.1.1）</li><li>进入&quot;DHCP服务器&quot;或&quot;网络设置&quot;</li><li>启用DHCP服务器</li><li>设置地址池范围</li><li>配置网关和DNS</li><li>保存设置</li></ol><h4 id="_3-2-windows-server-dhcp配置" tabindex="-1">3.2 Windows Server DHCP配置 <a class="header-anchor" href="#_3-2-windows-server-dhcp配置" aria-label="Permalink to &quot;3.2 Windows Server DHCP配置&quot;">​</a></h4><p><strong>安装DHCP服务</strong>：</p><div class="language-powershell vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">powershell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装DHCP服务器角色</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Install-WindowsFeature</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> -</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Name DHCP </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">IncludeManagementTools</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>配置DHCP作用域</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>作用域名称：办公室网络</span></span>
<span class="line"><span>IP地址范围：192.168.1.100 ~ 192.168.1.200</span></span>
<span class="line"><span>子网掩码：255.255.255.0</span></span>
<span class="line"><span>排除地址：192.168.1.150 ~ 192.168.1.160（保留给服务器）</span></span>
<span class="line"><span>租约时间：8小时</span></span>
<span class="line"><span>默认网关：192.168.1.1</span></span>
<span class="line"><span>DNS服务器：192.168.1.10, 8.8.8.8</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_3-3-linux-dhcp服务器配置-isc-dhcp-server" tabindex="-1">3.3 Linux DHCP服务器配置（isc-dhcp-server） <a class="header-anchor" href="#_3-3-linux-dhcp服务器配置-isc-dhcp-server" aria-label="Permalink to &quot;3.3 Linux DHCP服务器配置（isc-dhcp-server）&quot;">​</a></h4><p><strong>安装</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Ubuntu/Debian</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isc-dhcp-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># CentOS/RHEL</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yum</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhcp</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>配置文件</strong>：<code>/etc/dhcp/dhcpd.conf</code></p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 子网配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">subnet</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> netmask</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 255.255.255.0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # IP地址池</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    range</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.100</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.200</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 默认网关</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> routers</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # DNS服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> domain-name-servers</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 192.168.1.1,</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8.8.8.8</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 域名</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> domain-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;example.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 租约时间（秒）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    default-lease-time</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 28800</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 8小时</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    max-lease-time</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 86400</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;     </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 24小时</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 排除的IP地址（保留给服务器）</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> server1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ethernet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:11:22:33:44:55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        fixed-address</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>启动服务</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isc-dhcp-server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> enable</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isc-dhcp-server</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="_4-dhcp客户端配置" tabindex="-1">4 DHCP客户端配置 <a class="header-anchor" href="#_4-dhcp客户端配置" aria-label="Permalink to &quot;4 DHCP客户端配置&quot;">​</a></h3><h4 id="_4-1-windows客户端" tabindex="-1">4.1 Windows客户端 <a class="header-anchor" href="#_4-1-windows客户端" aria-label="Permalink to &quot;4.1 Windows客户端&quot;">​</a></h4><p><strong>自动获取IP地址（默认）</strong>：</p><div class="language-cmd vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 查看当前IP配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ipconfig</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 释放IP地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ipconfig /release</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 重新获取IP地址</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ipconfig /renew</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 查看详细信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ipconfig /all</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>手动配置静态IP</strong>：</p><ol><li>打开&quot;网络和共享中心&quot;</li><li>点击&quot;更改适配器设置&quot;</li><li>右键网络适配器 → &quot;属性&quot;</li><li>选择&quot;Internet协议版本4（TCP/IPv4）&quot; → &quot;属性&quot;</li><li>选择&quot;使用下面的IP地址&quot;</li><li>填写IP地址、子网掩码、默认网关、DNS服务器</li></ol><h4 id="_4-2-linux客户端" tabindex="-1">4.2 Linux客户端 <a class="header-anchor" href="#_4-2-linux客户端" aria-label="Permalink to &quot;4.2 Linux客户端&quot;">​</a></h4><p><strong>使用NetworkManager（自动）</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看网络配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmcli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> show</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改为自动获取</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmcli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> modify</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Wired connection 1&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ipv4.method</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> auto</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 重新连接</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">nmcli</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> connection</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> up</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;Wired connection 1&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>使用dhclient（手动）</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 释放IP地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhclient</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -r</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 获取IP地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dhclient</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看租约信息</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/dhcp/dhclient.leases</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>使用systemd-networkd</strong>：</p><div class="language-ini vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">ini</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/systemd/network/20-wired.network</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Match]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">Name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=eth0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">[Network]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">DHCP</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=yes</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="_4-3-macos客户端" tabindex="-1">4.3 macOS客户端 <a class="header-anchor" href="#_4-3-macos客户端" aria-label="Permalink to &quot;4.3 macOS客户端&quot;">​</a></h4><p><strong>使用命令行</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 释放IP地址</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ipconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> set</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> en0</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DHCP</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 或使用网络偏好设置</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 系统偏好设置 → 网络 → 选择接口 → 使用DHCP</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="_5-dhcp保留地址-静态分配" tabindex="-1">5 DHCP保留地址（静态分配） <a class="header-anchor" href="#_5-dhcp保留地址-静态分配" aria-label="Permalink to &quot;5 DHCP保留地址（静态分配）&quot;">​</a></h3><p><strong>什么是DHCP保留</strong>：</p><ul><li>为特定设备（通过MAC地址）分配固定的IP地址</li><li>设备仍然通过DHCP获取IP，但每次都会得到相同的地址</li><li>结合了DHCP的便利性和静态IP的稳定性</li></ul><p><strong>配置示例</strong>（路由器）：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>MAC地址：00:11:22:33:44:55</span></span>
<span class="line"><span>保留IP地址：192.168.1.50</span></span>
<span class="line"><span>设备名称：打印机</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>配置示例</strong>（Linux DHCP服务器）：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/dhcp/dhcpd.conf</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">host</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> printer</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    hardware</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ethernet</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 00:11:22:33:44:55</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    fixed-address</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.50</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    option</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> host-name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;printer&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>应用场景</strong>：</p><ul><li>服务器需要固定IP地址</li><li>网络打印机需要固定IP</li><li>网络摄像头需要固定IP</li><li>需要端口转发的设备</li></ul><h3 id="_6-dhcp中继-relay" tabindex="-1">6 DHCP中继（Relay） <a class="header-anchor" href="#_6-dhcp中继-relay" aria-label="Permalink to &quot;6 DHCP中继（Relay）&quot;">​</a></h3><p><strong>什么是DHCP中继</strong>：</p><ul><li>当客户端和DHCP服务器不在同一网段时，需要DHCP中继</li><li>中继代理转发DHCP消息，使跨网段分配成为可能</li></ul><p><strong>工作原理</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>客户端（网段A） → 路由器（DHCP中继） → DHCP服务器（网段B）</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>配置示例</strong>（Cisco路由器）：</p><div class="language-cisco vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cisco</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>interface GigabitEthernet0/0</span></span>
<span class="line"><span> ip helper-address 192.168.10.100  # DHCP服务器地址</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>配置示例</strong>（Linux）：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 安装dhcrelay</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> apt-get</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isc-dhcp-relay</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 配置</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># /etc/default/isc-dhcp-relay</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SERVERS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;192.168.10.100&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">INTERFACES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;eth0 eth1&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="_7-dhcp故障排查" tabindex="-1">7 DHCP故障排查 <a class="header-anchor" href="#_7-dhcp故障排查" aria-label="Permalink to &quot;7 DHCP故障排查&quot;">​</a></h3><h4 id="_7-1-常见问题" tabindex="-1">7.1 常见问题 <a class="header-anchor" href="#_7-1-常见问题" aria-label="Permalink to &quot;7.1 常见问题&quot;">​</a></h4><p><strong>问题1：无法获取IP地址</strong></p><p><strong>症状</strong>：</p><ul><li>设备显示169.254.x.x（链路本地地址）</li><li>网络连接显示&quot;受限&quot;或&quot;无Internet访问&quot;</li></ul><p><strong>排查步骤</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 检查DHCP服务是否运行</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows Server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get-Service</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> DHCPServer</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sudo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> isc-dhcp-server</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 检查地址池是否耗尽</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看DHCP租约</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows Server</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get-DhcpServerv4Lease</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -ScopeId</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.0</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/dhcp/dhcpd.leases</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 检查网络连接</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ping</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 192.168.1.1</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 网关</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4. 检查防火墙</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 确保UDP端口67（服务器）和68（客户端）开放</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 5. 客户端重新获取</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ipconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /release</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ipconfig</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /renew</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><strong>问题2：IP地址冲突</strong></p><p><strong>症状</strong>：</p><ul><li>设备提示IP地址冲突</li><li>网络连接不稳定</li></ul><p><strong>解决方法</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 检查是否有设备使用静态IP，但该IP在DHCP地址池中</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 从DHCP地址池中排除冲突的IP</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 或者将静态IP设备改为使用DHCP保留</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Windows：查看冲突的IP</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux：查看ARP表</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">arp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -a</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>问题3：租约无法更新</strong></p><p><strong>症状</strong>：</p><ul><li>设备定期失去网络连接</li><li>需要手动重新获取IP</li></ul><p><strong>解决方法</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1. 检查DHCP服务器是否可达</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ping</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">DHCP服务器I</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">P</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2. 检查租约时间设置</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 如果租约时间太短，可以增加</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3. 检查网络稳定性</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 确保客户端和服务器之间网络稳定</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_7-2-诊断工具" tabindex="-1">7.2 诊断工具 <a class="header-anchor" href="#_7-2-诊断工具" aria-label="Permalink to &quot;7.2 诊断工具&quot;">​</a></h4><p><strong>Wireshark抓包分析</strong>：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>过滤器：bootp 或 dhcp</span></span>
<span class="line"><span>可以查看完整的DORA过程</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p><strong>Windows诊断</strong>：</p><div class="language-cmd vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cmd</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 查看DHCP租约信息</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ipconfig /all</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 查看详细网络配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh interface ip show config</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"># 重置网络配置</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh winsock reset</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">netsh </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ip reset</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>Linux诊断</strong>：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看DHCP租约</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /var/lib/dhcp/dhclient.leases</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看网络配置</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> addr</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> show</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ip</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> route</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> show</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 测试DHCP服务器</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">dhclient</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> eth0</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="_8-dhcp-vs-静态ip" tabindex="-1">8 DHCP vs 静态IP <a class="header-anchor" href="#_8-dhcp-vs-静态ip" aria-label="Permalink to &quot;8 DHCP vs 静态IP&quot;">​</a></h3><table tabindex="0"><thead><tr><th>特性</th><th>DHCP</th><th>静态IP</th></tr></thead><tbody><tr><td>配置方式</td><td>自动</td><td>手动</td></tr><tr><td>IP地址</td><td>动态分配</td><td>固定</td></tr><tr><td>管理难度</td><td>简单</td><td>复杂</td></tr><tr><td>适用场景</td><td>客户端设备</td><td>服务器、网络设备</td></tr><tr><td>IP冲突风险</td><td>低（服务器管理）</td><td>高（手动管理）</td></tr><tr><td>灵活性</td><td>高</td><td>低</td></tr><tr><td>移动性</td><td>好（自动适应网络）</td><td>差（需要重新配置）</td></tr></tbody></table><p><strong>选择建议</strong>：</p><ul><li><strong>使用DHCP</strong>：客户端设备、移动设备、临时设备</li><li><strong>使用静态IP</strong>：服务器、网络设备、需要固定IP的服务</li><li><strong>使用DHCP保留</strong>：需要固定IP但想利用DHCP管理的设备</li></ul><h3 id="_9-dhcp安全考虑" tabindex="-1">9 DHCP安全考虑 <a class="header-anchor" href="#_9-dhcp安全考虑" aria-label="Permalink to &quot;9 DHCP安全考虑&quot;">​</a></h3><p><strong>1. DHCP欺骗攻击（DHCP Spoofing）</strong></p><p><strong>攻击方式</strong>：</p><ul><li>攻击者在网络中部署恶意DHCP服务器</li><li>客户端可能从恶意服务器获取错误的网络配置</li><li>可能导致中间人攻击</li></ul><p><strong>防护措施</strong>：</p><ul><li>使用DHCP Snooping（交换机功能）</li><li>限制DHCP服务器端口</li><li>使用802.1X认证</li></ul><p><strong>2. 地址池耗尽攻击</strong></p><p><strong>攻击方式</strong>：</p><ul><li>攻击者快速请求大量IP地址</li><li>耗尽DHCP地址池</li><li>导致合法用户无法获取IP</li></ul><p><strong>防护措施</strong>：</p><ul><li>限制每个端口的MAC地址数量</li><li>监控DHCP租约数量</li><li>设置合理的租约时间</li></ul><p><strong>3. 最佳实践</strong></p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>✅ 定期审查DHCP租约</span></span>
<span class="line"><span>✅ 监控异常DHCP活动</span></span>
<span class="line"><span>✅ 使用DHCP保留管理重要设备</span></span>
<span class="line"><span>✅ 定期更新DHCP服务器软件</span></span>
<span class="line"><span>✅ 限制DHCP服务器访问权限</span></span>
<span class="line"><span>✅ 使用VLAN隔离不同网络</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div>`,132)])])}const o=a(p,[["render",e]]);export{b as __pageData,o as default};
