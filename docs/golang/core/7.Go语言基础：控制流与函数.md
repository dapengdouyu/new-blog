---
title: 7ã€Goè¯­è¨€åŸºç¡€ï¼šæ§åˆ¶æµä¸å‡½æ•°
date: 2026-01-06
description: æ·±å…¥ç†è§£Goè¯­è¨€çš„æ¡ä»¶è¯­å¥ã€å¾ªç¯è¯­å¥å’Œå‡½æ•°æœºåˆ¶
---

# 7ã€Goè¯­è¨€åŸºç¡€ï¼šæ§åˆ¶æµä¸å‡½æ•°

æœ¬æ–‡æ¡£ç³»ç»Ÿè®²è§£Goè¯­è¨€çš„æ§åˆ¶æµè¯­å¥å’Œå‡½æ•°æœºåˆ¶ï¼Œæ˜¯ç¼–å†™æœ‰é€»è¾‘çš„ç¨‹åºçš„åŸºç¡€ã€‚

## ğŸ¯ æœ¬è¯¾å­¦ä¹ ç›®æ ‡

å®Œæˆæœ¬è¯¾åï¼Œä½ å°†èƒ½å¤Ÿï¼š
- âœ… æŒæ¡æ¡ä»¶è¯­å¥ï¼ˆifï¼‰çš„ä½¿ç”¨
- âœ… æŒæ¡å¾ªç¯è¯­å¥ï¼ˆforï¼‰çš„å„ç§å½¢å¼
- âœ… ç†è§£å‡½æ•°çš„å®šä¹‰ã€è°ƒç”¨å’Œå‚æ•°ä¼ é€’
- âœ… æŒæ¡deferè¯­å¥çš„ä½¿ç”¨
- âœ… ç†è§£åŒ¿åå‡½æ•°å’Œé—­åŒ…

---

## ä¸€ã€æ¡ä»¶è¯­å¥ï¼ˆifï¼‰

### 1.1 åŸºæœ¬ifè¯­å¥

```go
package main

import "fmt"

func main() {
    score := 85
    
    if score >= 90 {
        fmt.Println("ä¼˜ç§€")
    } else if score >= 80 {
        fmt.Println("è‰¯å¥½")
    } else {
        fmt.Println("éœ€è¦åŠªåŠ›")
    }
}
```

### 1.2 ifçš„åˆå§‹åŒ–è¯­å¥

Goè¯­è¨€çš„ifè¯­å¥æ”¯æŒåœ¨æ¡ä»¶å‰æ‰§è¡Œåˆå§‹åŒ–è¯­å¥ï¼š

```go
// è¯­æ³•ï¼šif init; condition { }
if err := doSomething(); err != nil {
    fmt.Println("é”™è¯¯:", err)
}

// å¸¸è§ç”¨æ³•ï¼šé”™è¯¯å¤„ç†
if file, err := os.Open("file.txt"); err != nil {
    fmt.Println("æ‰“å¼€æ–‡ä»¶å¤±è´¥:", err)
} else {
    defer file.Close()
    // ä½¿ç”¨file
}
```

### 1.3 ifçš„ä½œç”¨åŸŸ

ifè¯­å¥ä¸­çš„åˆå§‹åŒ–å˜é‡ä½œç”¨åŸŸä»…é™äºif-elseå—ï¼š

```go
if x := 10; x > 5 {
    fmt.Println(x)  // 10
}
// fmt.Println(x)  // ç¼–è¯‘é”™è¯¯ï¼šxæœªå®šä¹‰

// å¦‚æœéœ€è¦åœ¨å¤–å±‚ä½¿ç”¨ï¼Œåœ¨å¤–å±‚å£°æ˜
var x int
if x = 10; x > 5 {
    fmt.Println(x)
}
fmt.Println(x)  // 10
```

### 1.4 å¸¸è§æ¨¡å¼

#### 1. é”™è¯¯å¤„ç†

```go
if err := function(); err != nil {
    return err
}
```

#### 2. ç±»å‹æ–­è¨€

```go
if value, ok := interfaceVar.(string); ok {
    fmt.Println("æ˜¯å­—ç¬¦ä¸²:", value)
}
```

#### 3. Mapæ£€æŸ¥

```go
if value, exists := m["key"]; exists {
    fmt.Println("å€¼:", value)
}
```

---

## äºŒã€å¾ªç¯è¯­å¥ï¼ˆforï¼‰

### 2.1 ä¼ ç»Ÿforå¾ªç¯

Goè¯­è¨€åªæœ‰`for`ä¸€ç§å¾ªç¯è¯­å¥ï¼Œä½†æ”¯æŒå¤šç§å½¢å¼ï¼š

```go
// 1. ä¼ ç»Ÿä¸‰éƒ¨åˆ†å½¢å¼
for i := 0; i < 10; i++ {
    fmt.Println(i)
}

// 2. ç±»ä¼¼whileå¾ªç¯
i := 0
for i < 10 {
    fmt.Println(i)
    i++
}

// 3. æ— é™å¾ªç¯
for {
    // éœ€è¦breaké€€å‡º
    if condition {
        break
    }
}
```

### 2.2 for-rangeå¾ªç¯

ç”¨äºéå†æ•°ç»„ã€åˆ‡ç‰‡ã€å­—ç¬¦ä¸²ã€mapå’Œé€šé“ï¼š

```go
// éå†åˆ‡ç‰‡
nums := []int{1, 2, 3, 4, 5}
for index, value := range nums {
    fmt.Println(index, value)
}

// åªè·å–å€¼
for _, value := range nums {
    fmt.Println(value)
}

// åªè·å–ç´¢å¼•
for index := range nums {
    fmt.Println(index)
}

// éå†å­—ç¬¦ä¸²ï¼ˆæŒ‰runeï¼‰
str := "Hello"
for i, char := range str {
    fmt.Printf("%d: %c\n", i, char)
}

// éå†map
m := map[string]int{"a": 1, "b": 2}
for key, value := range m {
    fmt.Println(key, value)
}
```

### 2.3 å¾ªç¯æ§åˆ¶

#### breakå’Œcontinue

```go
// breakï¼šè·³å‡ºå¾ªç¯
for i := 0; i < 10; i++ {
    if i == 5 {
        break  // è·³å‡ºå¾ªç¯
    }
    fmt.Println(i)  // 0, 1, 2, 3, 4
}

// continueï¼šè·³è¿‡æœ¬æ¬¡å¾ªç¯
for i := 0; i < 10; i++ {
    if i%2 == 0 {
        continue  // è·³è¿‡å¶æ•°
    }
    fmt.Println(i)  // 1, 3, 5, 7, 9
}
```

#### æ ‡ç­¾ï¼ˆLabelï¼‰

ä½¿ç”¨æ ‡ç­¾å¯ä»¥è·³å‡ºå¤–å±‚å¾ªç¯ï¼š

```go
outer:
for i := 0; i < 3; i++ {
    for j := 0; j < 3; j++ {
        if i == 1 && j == 1 {
            break outer  // è·³å‡ºå¤–å±‚å¾ªç¯
        }
        fmt.Println(i, j)
    }
}
```

### 2.4 forå¾ªç¯çš„å¸¸è§æ¨¡å¼

#### 1. éå†å¹¶ä¿®æ”¹åˆ‡ç‰‡

```go
nums := []int{1, 2, 3, 4, 5}
for i := range nums {
    nums[i] *= 2  // ä¿®æ”¹åŸåˆ‡ç‰‡
}
fmt.Println(nums)  // [2 4 6 8 10]
```

#### 2. æŸ¥æ‰¾å…ƒç´ 

```go
nums := []int{1, 2, 3, 4, 5}
target := 3
found := false

for _, num := range nums {
    if num == target {
        found = true
        break
    }
}
```

#### 3. ç´¯åŠ /èšåˆ

```go
nums := []int{1, 2, 3, 4, 5}
sum := 0
for _, num := range nums {
    sum += num
}
fmt.Println(sum)  // 15
```

---

## ä¸‰ã€å‡½æ•°ï¼ˆFunctionï¼‰

### 3.1 å‡½æ•°çš„åŸºæœ¬å®šä¹‰

```go
package main

import "fmt"

// åŸºæœ¬å‡½æ•°
func greet(name string) {
    fmt.Println("Hello,", name)
}

// å¸¦è¿”å›å€¼çš„å‡½æ•°
func add(a, b int) int {
    return a + b
}

// å¤šä¸ªè¿”å›å€¼
func divide(a, b float64) (float64, error) {
    if b == 0 {
        return 0, fmt.Errorf("é™¤æ•°ä¸èƒ½ä¸º0")
    }
    return a / b, nil
}

func main() {
    greet("Alice")
    result := add(3, 5)
    fmt.Println(result)  // 8
    
    quotient, err := divide(10, 2)
    if err != nil {
        fmt.Println("é”™è¯¯:", err)
    } else {
        fmt.Println("ç»“æœ:", quotient)  // 5
    }
}
```

### 3.2 å‡½æ•°ç­¾å

å‡½æ•°ç­¾ååŒ…æ‹¬ï¼šå‡½æ•°åã€å‚æ•°åˆ—è¡¨ã€è¿”å›å€¼åˆ—è¡¨ã€‚

```go
// ç­¾åï¼šfunc(int, int) int
func add(a, b int) int {
    return a + b
}

// ç­¾åï¼šfunc(string, ...int) (int, error)
func sum(prefix string, numbers ...int) (int, error) {
    // ...
}
```

### 3.3 å‘½åè¿”å›å€¼

Goè¯­è¨€æ”¯æŒå‘½åè¿”å›å€¼ï¼Œå¯ä»¥åœ¨å‡½æ•°ä½“ä¸­ç›´æ¥ä½¿ç”¨ï¼š

```go
// å‘½åè¿”å›å€¼
func calculate(x, y int) (sum int, product int) {
    sum = x + y        // ç›´æ¥èµ‹å€¼ï¼Œæ— éœ€å£°æ˜
    product = x * y
    return             // è‡ªåŠ¨è¿”å›å‘½åè¿”å›å€¼
}

// ç­‰ä»·äº
func calculate2(x, y int) (int, int) {
    sum := x + y
    product := x * y
    return sum, product
}
```

**æ³¨æ„**ï¼šå‘½åè¿”å›å€¼ä¼šè¢«åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼Œå³ä½¿æ²¡æœ‰æ˜¾å¼èµ‹å€¼ã€‚

### 3.4 å¯å˜å‚æ•°ï¼ˆVariadicï¼‰

ä½¿ç”¨`...`å®šä¹‰å¯å˜å‚æ•°ï¼š

```go
package main

import "fmt"

// å¯å˜å‚æ•°å¿…é¡»æ˜¯æœ€åä¸€ä¸ªå‚æ•°
func sum(numbers ...int) int {
    total := 0
    for _, num := range numbers {
        total += num
    }
    return total
}

func main() {
    fmt.Println(sum(1, 2, 3))        // 6
    fmt.Println(sum(1, 2, 3, 4, 5))  // 15
    
    // ä¼ é€’åˆ‡ç‰‡
    nums := []int{1, 2, 3}
    fmt.Println(sum(nums...))        // 6
}
```

### 3.5 å‡½æ•°ä½œä¸ºå€¼

åœ¨Goè¯­è¨€ä¸­ï¼Œå‡½æ•°æ˜¯**ä¸€ç­‰å…¬æ°‘**ï¼Œå¯ä»¥ä½œä¸ºå€¼ä¼ é€’ï¼š

```go
package main

import "fmt"

// å‡½æ•°ç±»å‹
type Operation func(int, int) int

func add(a, b int) int {
    return a + b
}

func multiply(a, b int) int {
    return a * b
}

// å‡½æ•°ä½œä¸ºå‚æ•°
func calculate(a, b int, op Operation) int {
    return op(a, b)
}

func main() {
    result1 := calculate(3, 4, add)       // 7
    result2 := calculate(3, 4, multiply)  // 12
    
    fmt.Println(result1, result2)
}
```

### 3.6 åŒ¿åå‡½æ•°å’Œé—­åŒ…

#### åŒ¿åå‡½æ•°

```go
// ç«‹å³æ‰§è¡Œ
func() {
    fmt.Println("åŒ¿åå‡½æ•°")
}()

// èµ‹å€¼ç»™å˜é‡
add := func(a, b int) int {
    return a + b
}
result := add(3, 5)
```

#### é—­åŒ…ï¼ˆClosureï¼‰

é—­åŒ…å¯ä»¥æ•è·å¤–éƒ¨å˜é‡ï¼š

```go
package main

import "fmt"

func counter() func() int {
    count := 0
    return func() int {
        count++
        return count
    }
}

func main() {
    c1 := counter()
    fmt.Println(c1())  // 1
    fmt.Println(c1())  // 2
    fmt.Println(c1())  // 3
    
    c2 := counter()
    fmt.Println(c2())  // 1ï¼ˆç‹¬ç«‹çš„é—­åŒ…ï¼‰
}
```

#### é—­åŒ…çš„å¸¸è§é™·é˜±

```go
// é™·é˜±ï¼šå¾ªç¯å˜é‡é—®é¢˜ï¼ˆGo 1.22å·²ä¿®å¤for-rangeï¼‰
var funcs []func()
for i := 0; i < 3; i++ {
    // é”™è¯¯ï¼šæ‰€æœ‰é—­åŒ…å…±äº«åŒä¸€ä¸ªi
    funcs = append(funcs, func() {
        fmt.Println(i)  // éƒ½è¾“å‡º3
    })
}

// æ­£ç¡®ï¼šåˆ›å»ºå±€éƒ¨å‰¯æœ¬
for i := 0; i < 3; i++ {
    i := i  // åˆ›å»ºå±€éƒ¨å‰¯æœ¬
    funcs = append(funcs, func() {
        fmt.Println(i)  // 0, 1, 2
    })
}
```

### 3.7 deferè¯­å¥

`defer`ç”¨äºå»¶è¿Ÿæ‰§è¡Œå‡½æ•°ï¼Œå¸¸ç”¨äºèµ„æºæ¸…ç†ï¼š

```go
package main

import "fmt"

func main() {
    defer fmt.Println("æœ€åæ‰§è¡Œ")
    fmt.Println("å…ˆæ‰§è¡Œ")
    fmt.Println("ä¸­é—´æ‰§è¡Œ")
    // è¾“å‡ºï¼š
    // å…ˆæ‰§è¡Œ
    // ä¸­é—´æ‰§è¡Œ
    // æœ€åæ‰§è¡Œ
}
```

#### deferçš„æ‰§è¡Œé¡ºåº

å¤šä¸ªdeferæŒ‰**åè¿›å…ˆå‡ºï¼ˆLIFOï¼‰**é¡ºåºæ‰§è¡Œï¼š

```go
func main() {
    defer fmt.Println("1")
    defer fmt.Println("2")
    defer fmt.Println("3")
    // è¾“å‡ºï¼š3, 2, 1
}
```

#### deferçš„å¸¸è§ç”¨é€”

```go
// 1. å…³é—­æ–‡ä»¶
file, err := os.Open("file.txt")
if err != nil {
    return err
}
defer file.Close()  // ç¡®ä¿æ–‡ä»¶è¢«å…³é—­

// 2. è§£é”
mu.Lock()
defer mu.Unlock()

// 3. æ¢å¤panic
defer func() {
    if r := recover(); r != nil {
        fmt.Println("æ¢å¤:", r)
    }
}()
```

#### deferçš„å‚æ•°æ±‚å€¼

deferçš„å‚æ•°åœ¨**å£°æ˜æ—¶**æ±‚å€¼ï¼Œè€Œéæ‰§è¡Œæ—¶ï¼š

```go
func main() {
    x := 1
    defer fmt.Println(x)  // è¾“å‡º1ï¼ˆä¸æ˜¯2ï¼‰
    x = 2
}

// å¦‚æœéœ€è¦ä½¿ç”¨æ‰§è¡Œæ—¶çš„å€¼
func main() {
    x := 1
    defer func() {
        fmt.Println(x)  // è¾“å‡º2
    }()
    x = 2
}
```

### 3.8 æ–¹æ³•ï¼ˆMethodï¼‰

æ–¹æ³•æ˜¯æœ‰æ¥æ”¶è€…çš„å‡½æ•°ï¼š

```go
type Rectangle struct {
    Width, Height float64
}

// å€¼æ¥æ”¶è€…æ–¹æ³•
func (r Rectangle) Area() float64 {
    return r.Width * r.Height
}

// æŒ‡é’ˆæ¥æ”¶è€…æ–¹æ³•
func (r *Rectangle) Scale(factor float64) {
    r.Width *= factor
    r.Height *= factor
}
```

### 3.9 å‡½æ•°çš„æœ€ä½³å®è·µ

```go
// âœ… é”™è¯¯å¤„ç†ï¼šè¿”å›error
func doSomething() error {
    // ...
    return nil
}

// âœ… ä½¿ç”¨å‘½åè¿”å›å€¼æé«˜å¯è¯»æ€§
func parse(input string) (result string, err error) {
    // ...
}

// âœ… ä½¿ç”¨deferç¡®ä¿èµ„æºæ¸…ç†
func readFile(filename string) error {
    file, err := os.Open(filename)
    if err != nil {
        return err
    }
    defer file.Close()
    // ...
}

// âœ… å‡½æ•°åº”è¯¥çŸ­å°ç²¾æ‚ï¼Œå•ä¸€èŒè´£
func calculateTotal(items []Item) float64 {
    // ...
}

// âŒ é¿å…è¿‡é•¿çš„å‡½æ•°
// âŒ é¿å…è¿‡å¤šçš„å‚æ•°ï¼ˆè¶…è¿‡3-4ä¸ªè€ƒè™‘ä½¿ç”¨ç»“æ„ä½“ï¼‰
```

---

## å››ã€ç»¼åˆç¤ºä¾‹

```go
package main

import (
    "fmt"
    "errors"
)

// è®¡ç®—å™¨ç»“æ„ä½“
type Calculator struct {
    result float64
}

// æ„é€ å‡½æ•°
func NewCalculator() *Calculator {
    return &Calculator{result: 0}
}

// åŠ æ³•
func (c *Calculator) Add(value float64) {
    c.result += value
}

// å‡æ³•
func (c *Calculator) Subtract(value float64) {
    c.result -= value
}

// ä¹˜æ³•
func (c *Calculator) Multiply(value float64) {
    c.result *= value
}

// é™¤æ³•
func (c *Calculator) Divide(value float64) error {
    if value == 0 {
        return errors.New("é™¤æ•°ä¸èƒ½ä¸º0")
    }
    c.result /= value
    return nil
}

// è·å–ç»“æœ
func (c *Calculator) GetResult() float64 {
    return c.result
}

// é‡ç½®
func (c *Calculator) Reset() {
    c.result = 0
}

func main() {
    calc := NewCalculator()
    
    // æ‰§è¡Œä¸€ç³»åˆ—è®¡ç®—
    operations := []struct {
        op    string
        value float64
    }{
        {"add", 10},
        {"multiply", 2},
        {"subtract", 5},
        {"divide", 3},
    }
    
    for _, op := range operations {
        switch op.op {
        case "add":
            calc.Add(op.value)
        case "subtract":
            calc.Subtract(op.value)
        case "multiply":
            calc.Multiply(op.value)
        case "divide":
            if err := calc.Divide(op.value); err != nil {
                fmt.Println("é”™è¯¯:", err)
                return
            }
        }
        fmt.Printf("æ‰§è¡Œ %s %.2fï¼Œå½“å‰ç»“æœ: %.2f\n", op.op, op.value, calc.GetResult())
    }
    
    fmt.Printf("\næœ€ç»ˆç»“æœ: %.2f\n", calc.GetResult())
}
```

---

## æ€»ç»“

1. **ifè¯­å¥**ï¼šæ”¯æŒåˆå§‹åŒ–è¯­å¥ï¼Œä½œç”¨åŸŸé™åˆ¶åœ¨if-elseå—å†…ï¼Œå¸¸ç”¨äºé”™è¯¯å¤„ç†
2. **forå¾ªç¯**ï¼šå”¯ä¸€çš„å¾ªç¯è¯­å¥ï¼Œæ”¯æŒå¤šç§å½¢å¼ï¼Œæ³¨æ„å¾ªç¯å˜é‡çš„ä½œç”¨åŸŸ
3. **å‡½æ•°**ï¼šä¸€ç­‰å…¬æ°‘ï¼Œæ”¯æŒå¤šè¿”å›å€¼ã€å¯å˜å‚æ•°ã€é—­åŒ…ï¼Œä½¿ç”¨deferè¿›è¡Œèµ„æºæ¸…ç†
4. **deferè¯­å¥**ï¼šæŒ‰LIFOé¡ºåºæ‰§è¡Œï¼Œå‚æ•°åœ¨å£°æ˜æ—¶æ±‚å€¼ï¼Œå¸¸ç”¨äºèµ„æºæ¸…ç†
5. **é—­åŒ…**ï¼šå¯ä»¥æ•è·å¤–éƒ¨å˜é‡ï¼Œæ³¨æ„å¾ªç¯å˜é‡çš„é™·é˜±

æŒæ¡è¿™äº›æ ¸å¿ƒç‰¹æ€§ï¼Œæ˜¯ç¼–å†™é«˜è´¨é‡Goä»£ç çš„åŸºç¡€ã€‚åœ¨å®é™…å¼€å‘ä¸­ï¼Œè¦ç‰¹åˆ«æ³¨æ„ï¼š
- forå¾ªç¯å˜é‡çš„ä½œç”¨åŸŸé™·é˜±
- deferçš„æ‰§è¡Œæ—¶æœºå’Œå‚æ•°æ±‚å€¼
- å‡½æ•°çš„é”™è¯¯å¤„ç†æ¨¡å¼
- é—­åŒ…çš„æ­£ç¡®ä½¿ç”¨æ–¹å¼
